"use strict";!function(){var i=$("#form-login"),t=$(".login_error"),o={qryLoginType:"/api/web/hdc/qryLoginType",loginConfig:"/api/web/hdc/login",qryImgCode:"/api/web/hdc/getPictureV"};function r(e){Rui.request("post",o.qryImgCode,{username:i.find(".loginname").val()},function(e){if(!e.flag)return alert("j错误");$(".Codeimg").attr("src","data:image/gif;base64,"+e.img)})}Rui.setCookie("access_token","",-1),Rui.request("post",o.qryLoginType,{isPc:2},function(e){if(!e.flag)return alert("j错误");n.loginItems=e.loginConfigInfo}),i.on("click",".logins",function(){var e=function(){var e=i.find(".loginname").val(),o=i.find(".password").val(),n=i.find(".form-Code").val();if(""==e||""==o)return t.find("span").text("请输入密码与账号"),t.show(),!1;if(5<=sessionStorage.getItem("loginerror")){if(i.find(".Codeimg").is(":hidden"))r(),i.find("#iscode").show();else{if(""!=n)return{username:e,password:o,code:n,type:1};t.find("span").text("请输入验证码"),t.show()}return!1}return{username:e,password:o,code:n,type:1}}();e&&Rui.request("post",o.loginConfig,e,function(e){if(!e.flag){var o=parseInt(sessionStorage.getItem("loginerror")||0);return 5==o?5==sessionStorage.getItem("loginerror")&&(t.show(),r(),i.find("#iscode").show()):sessionStorage.setItem("loginerror",++o),t.find("span").text(e.msg),void t.show()}Rui.setCookie("access_token",e.access_token,1),sessionStorage.setItem("loginerror",0),window.location.href="/"})}),i.on("focus","input",function(){t.hide()}),i.on("click",".Codeimg",function(){r()}),i.on("click","#QQLogin",function(){Rui.request("post",o.loginConfig,{type:3},function(e){e.flag&&(window.location.href=e.uri)})}),i.on("click","#weChatLogin",function(){Rui.request("post",o.loginConfig,{type:4},function(e){e.flag&&(e.uri=e.uri.replace(/\+/g," "),$(".dc-model").show(),$("#wxFrame").attr("src",e.uri))})}),$(document).on("click",".dc-model-fade",function(){$("#wxModel").hide()});var n=new Vue({el:"#app",data:{loginItems:""},methods:{},mounted:function(){this.$nextTick(function(){})}})}();